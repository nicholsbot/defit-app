(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{120:(e,t,i)=>{Promise.resolve().then(i.t.bind(i,347,23)),Promise.resolve().then(i.bind(i,4082)),Promise.resolve().then(i.bind(i,5332)),Promise.resolve().then(i.bind(i,2558)),Promise.resolve().then(i.bind(i,1966)),Promise.resolve().then(i.bind(i,2360))},347:()=>{},1950:(e,t,i)=>{"use strict";i.d(t,{Ct:()=>o,GV:()=>r,Hk:()=>s,NU:()=>n,R6:()=>d,ai:()=>a,u_:()=>l});let r=new Date("2026-01-12T00:00:00Z"),a=10,s=60,o=5e3,n=45,l={RUN_RUCK_WALK:{label:"Run/Ruck/Walk",unit:"miles",goal:12},ELLIPTICAL_ROW:{label:"Elliptical/Row",unit:"miles",goal:15},SWIM:{label:"Swim",unit:"meters",goal:3200},CYCLE:{label:"Cycle",unit:"miles",goal:40}},d={tmar:{id:"tmar",name:"TMAR-M"},strength:{id:"strength",name:"Strength & Resistance"},cardio:{id:"cardio",name:"Cardio"},hiit:{id:"hiit",name:"HIIT"}}},2360:(e,t,i)=>{"use strict";i.d(t,{H:()=>m,WorkoutProvider:()=>u});var r=i(5155),a=i(2115),s=i(1966),o=i(5317),n=i(1950),l=i(4202);let d={tmarAchieved:!1,strengthAchieved:!1,cardioAchieved:!1,hiitAchieved:!1,allWeeklyAchieved:!1},c=(0,a.createContext)(void 0),u=e=>{let{children:t}=e,{user:i}=(0,s.useUser)(),u=null;try{u=(0,s.useFirestore)()}catch(e){console.log("Firestore not available - running in demo mode")}let m=(0,s.useMemoFirebase)(()=>i&&u?(0,o.H9)(u,"users",i.uid):null,[i,u]),{data:p}=u?(0,s.useDoc)(m):{data:null},f=(0,s.useMemoFirebase)(()=>i&&u?(0,o.P)((0,o.rJ)(u,"workoutLogs"),(0,o._M)("userProfileId","==",i.uid)):null,[i,u]),{data:g}=u?(0,s.useCollection)(f):{data:(0,l.HP)()?l.rq:null},[h,v]=(0,a.useState)({}),[w,b]=(0,a.useState)(!1),[x,k]=(0,a.useState)("tmar"),[y,S]=(0,a.useState)(1),[M,A]=(0,a.useState)(1),[R,E]=(0,a.useState)(null),[C,I]=(0,a.useState)({}),[P,N]=(0,a.useState)(null),[T,_]=(0,a.useState)(!1),[W,j]=(0,a.useState)({showAchievementPopups:!0,showWeeklyCompletionPopups:!0}),[L,O]=(0,a.useState)(Object.keys(n.u_));(0,a.useEffect)(()=>{let e=Math.floor((new Date().getTime()-n.GV.getTime())/6048e5)+1,t=1;e>0&&e<=n.ai?t=e:e>n.ai&&(t=n.ai),S(t),A(t)},[]),(0,a.useEffect)(()=>{if(g){let e={};g.forEach(t=>{e[t.week]||(e[t.week]={tmar:0,strength:0,hiit:0,cardio:{runRuckWalk:0,ellipticalRow:0,swim:0,cycle:0}}),e[t.week].tmar+=t.tmarMMinutes,e[t.week].strength+=t.resistanceLbs,e[t.week].hiit+=t.hiitMinutes,e[t.week].cardio.runRuckWalk+=t.cardioMilesRunning+t.cardioMilesRucking+t.cardioMilesWalking,e[t.week].cardio.ellipticalRow+=t.cardioMilesElliptical+t.cardioMilesRowing,e[t.week].cardio.swim+=t.cardioMetersSwimming,e[t.week].cardio.cycle+=t.cardioMilesCycling}),v(e)}},[g]),(0,a.useEffect)(()=>{(null==p?void 0:p.availableCardio)&&O(p.availableCardio),(null==p?void 0:p.selectedMission)&&E(p.selectedMission)},[p]);let D=(0,a.useCallback)(async e=>{var t,r,a,s;if(!i)return;if((0,l.HP)()||!u)return void(0,l.Z0)("Adding workout to demo data (not persisted)");let n={userProfileId:i.uid,week:M,workoutDate:new Date().toISOString(),tmarMMinutes:e.tmar||0,resistanceLbs:e.strength||0,hiitMinutes:e.hiit||0,cardioMilesRunning:(null==(t=e.cardio)?void 0:t.runRuckWalk)||0,cardioMilesRucking:0,cardioMilesWalking:0,cardioMilesElliptical:(null==(r=e.cardio)?void 0:r.ellipticalRow)||0,cardioMilesRowing:0,cardioMetersSwimming:(null==(a=e.cardio)?void 0:a.swim)||0,cardioMilesCycling:(null==(s=e.cardio)?void 0:s.cycle)||0};await (0,o.gS)((0,o.rJ)(u,"workoutLogs"),n)},[i,u,M]),F=(0,a.useCallback)(async e=>{if(!i)return;if((0,l.HP)()||!u){(0,l.Z0)("Resetting week data in demo mode (not persisted)"),I(t=>({...t,[e]:{...d}}));return}let t=(0,o.P)((0,o.rJ)(u,"workoutLogs"),(0,o._M)("userProfileId","==",i.uid),(0,o._M)("week","==",e)),r=await (0,o.GG)(t),a=(0,o.wP)(u);r.forEach(e=>{a.delete(e.ref)}),await a.commit(),I(t=>({...t,[e]:{...d}}))},[i,u]),H=(0,a.useCallback)(async()=>{if(!i)return;if((0,l.HP)()||!u){(0,l.Z0)("Resetting all data in demo mode (not persisted)"),E(null),I({});return}let e=(0,o.P)((0,o.rJ)(u,"workoutLogs"),(0,o._M)("userProfileId","==",i.uid)),t=await (0,o.GG)(e),r=(0,o.wP)(u);t.forEach(e=>{r.delete(e.ref)}),await r.commit(),E(null),m&&await (0,o.BN)(m,{selectedMission:null},{merge:!0}),I({})},[i,u,m]),U=(0,a.useCallback)(async e=>{if(E(e),(0,l.HP)()||!u)return void(0,l.Z0)("Setting selected mission in demo mode (not persisted)");m&&await (0,o.BN)(m,{selectedMission:e},{merge:!0})},[m,u]),G=(0,a.useCallback)(async e=>{let t="function"==typeof e?e(L):e;if(O(t),(0,l.HP)()||!u)return void(0,l.Z0)("Setting available cardio in demo mode (not persisted)");m&&await (0,o.BN)(m,{availableCardio:t},{merge:!0})},[m,L,u]),V=(0,a.useMemo)(()=>{var e;return null!=(e=h[M])?e:{tmar:0,strength:0,hiit:0,cardio:{runRuckWalk:0,ellipticalRow:0,swim:0,cycle:0}}},[h,M]),B=(0,a.useMemo)(()=>{let e=V.tmar/n.Hk*100,t=V.strength/n.Ct*100,i=V.hiit/n.NU*100;return{tmar:e,strength:t,cardio:(V.cardio.runRuckWalk/n.u_.RUN_RUCK_WALK.goal+V.cardio.ellipticalRow/n.u_.ELLIPTICAL_ROW.goal+V.cardio.swim/n.u_.SWIM.goal+V.cardio.cycle/n.u_.CYCLE.goal)*100,hiit:i}},[V]);return(0,a.useEffect)(()=>{W.showAchievementPopups&&(()=>{var e;if(P||T)return;let t=null!=(e=C[M])?e:d,i=[{name:"TMAR-M",progress:B.tmar,key:"tmarAchieved",achieved:t.tmarAchieved},{name:"Strength & Resistance",progress:B.strength,key:"strengthAchieved",achieved:t.strengthAchieved},{name:"Cardio",progress:B.cardio,key:"cardioAchieved",achieved:t.cardioAchieved},{name:"HIIT",progress:B.hiit,key:"hiitAchieved",achieved:t.hiitAchieved}],r=!1,a={...t};for(let e of i)if(e.progress>=100&&!e.achieved){N({categoryName:e.name}),a[e.key]=!0,r=!0;break}if(r)return I(e=>({...e,[M]:a}));i.every(e=>e.progress>=100)&&!t.allWeeklyAchieved&&(_(!0),a.allWeeklyAchieved=!0,I(e=>({...e,[M]:a})))})()},[B,C,M,P,T,W.showAchievementPopups]),(0,r.jsx)(c.Provider,{value:{weeklyWorkouts:h,addWorkout:D,isDialogOpen:w,setIsDialogOpen:b,dialogInitialTab:x,setDialogInitialTab:k,currentWeek:y,displayedWeek:M,setDisplayedWeek:A,selectedMission:R,setSelectedMission:U,achievementToShow:P,setAchievementToShow:N,showWeeklyCompletion:T,setShowWeeklyCompletion:_,notificationSettings:W,setNotificationSettings:j,resetWeekData:F,resetAllData:H,availableCardio:L,setAvailableCardio:G,workoutLogs:g,userProfile:p},children:t})},m=()=>{let e=(0,a.useContext)(c);if(void 0===e)throw Error("useWorkoutLog must be used within a WorkoutProvider");return e}},2558:(e,t,i)=>{"use strict";i.d(t,{Toaster:()=>v});var r=i(5155),a=i(7481),s=i(2115),o=i(6621),n=i(2085),l=i(5318),d=i(9434);let c=o.Kq,u=s.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,r.jsx)(o.LM,{ref:t,className:(0,d.cn)("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",i),...a})});u.displayName=o.LM.displayName;let m=(0,n.F)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),p=s.forwardRef((e,t)=>{let{className:i,variant:a,...s}=e;return(0,r.jsx)(o.bL,{ref:t,className:(0,d.cn)(m({variant:a}),i),...s})});p.displayName=o.bL.displayName,s.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,r.jsx)(o.rc,{ref:t,className:(0,d.cn)("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",i),...a})}).displayName=o.rc.displayName;let f=s.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,r.jsx)(o.bm,{ref:t,className:(0,d.cn)("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",i),"toast-close":"",...a,children:(0,r.jsx)(l.A,{className:"h-4 w-4"})})});f.displayName=o.bm.displayName;let g=s.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,r.jsx)(o.hE,{ref:t,className:(0,d.cn)("text-sm font-semibold",i),...a})});g.displayName=o.hE.displayName;let h=s.forwardRef((e,t)=>{let{className:i,...a}=e;return(0,r.jsx)(o.VY,{ref:t,className:(0,d.cn)("text-sm opacity-90",i),...a})});function v(){let{toasts:e}=(0,a.dj)();return(0,r.jsxs)(c,{children:[e.map(function(e){let{id:t,title:i,description:a,action:s,...o}=e;return(0,r.jsxs)(p,{...o,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[i&&(0,r.jsx)(g,{children:i}),a&&(0,r.jsx)(h,{children:a})]}),s,(0,r.jsx)(f,{})]},t)}),(0,r.jsx)(u,{})]})}h.displayName=o.VY.displayName},4082:(e,t,i)=>{"use strict";i.d(t,{default:()=>o});var r=i(5155),a=i(2115);let s="defit-pwa-install-dismissed";function o(){let[e,t]=(0,a.useState)(null),[i,o]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||function(){let e=localStorage.getItem(s);if(!e)return!1;let t=parseInt(e,10);return!(Date.now()-t>6048e5)||(localStorage.removeItem(s),!1)}()||window.matchMedia("(display-mode: standalone)").matches)return;let e=e=>{e.preventDefault(),t(e),o(!0)};return window.addEventListener("beforeinstallprompt",e),()=>window.removeEventListener("beforeinstallprompt",e)},[]);let n=async()=>{if(!e)return;await e.prompt();let{outcome:i}=await e.userChoice;"accepted"===i&&console.log("[PWA] User accepted install prompt"),t(null),o(!1)};return i?(0,r.jsxs)("div",{style:{position:"fixed",bottom:0,left:0,right:0,zIndex:9999,backgroundColor:"#1a1a1a",borderTop:"2px solid #F0A30A",padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",gap:"12px",fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif"},children:[(0,r.jsxs)("p",{style:{margin:0,fontSize:"14px",color:"#e5e5e5",flex:1},children:["Add ",(0,r.jsx)("strong",{style:{color:"#F0A30A"},children:"DEFIT"})," to your home screen for the best experience"]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"8px",flexShrink:0},children:[(0,r.jsx)("button",{onClick:()=>{localStorage.setItem(s,Date.now().toString()),o(!1),t(null)},style:{background:"none",border:"1px solid #555",borderRadius:"6px",color:"#a3a3a3",padding:"8px 12px",fontSize:"13px",cursor:"pointer"},children:"Later"}),(0,r.jsx)("button",{onClick:n,style:{background:"#F0A30A",border:"none",borderRadius:"6px",color:"#222222",padding:"8px 16px",fontSize:"13px",fontWeight:600,cursor:"pointer"},children:"Install"})]})]}):null}},5332:(e,t,i)=>{"use strict";i.d(t,{default:()=>a});var r=i(2115);function a(){return(0,r.useEffect)(()=>{"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("[SW] Registered with scope:",e.scope),e.addEventListener("updatefound",()=>{let t=e.installing;t&&t.addEventListener("statechange",()=>{"activated"===t.state&&navigator.serviceWorker.controller&&console.log("[SW] New version available")})})}).catch(e=>{console.error("[SW] Registration failed:",e)})})},[]),null}},7481:(e,t,i)=>{"use strict";i.d(t,{dj:()=>m});var r=i(2115);let a=0,s=new Map,o=e=>{if(s.has(e))return;let t=setTimeout(()=>{s.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);s.set(e,t)},n=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:i}=t;return i?o(i):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===i||void 0===i?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=n(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,i=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:i});return c({type:"ADD_TOAST",toast:{...t,id:i,open:!0,onOpenChange:e=>{e||r()}}}),{id:i,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:i}})}}function m(){let[e,t]=r.useState(d);return r.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}}},e=>{var t=t=>e(e.s=t);e.O(0,[690,992,644,277,698,970,234,749,441,684,358],()=>t(120)),_N_E=e.O()}]);