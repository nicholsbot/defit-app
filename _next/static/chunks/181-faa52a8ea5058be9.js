"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[181],{4237:(e,r,a)=>{a.d(r,{p:()=>m});var s=a(5155),t=a(2115),l=a(5977),n=a(9434);let i=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,s.jsx)(l.bL,{ref:r,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...t})});i.displayName=l.bL.displayName;let o=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,s.jsx)(l._V,{ref:r,className:(0,n.cn)("aspect-square h-full w-full",a),...t})});o.displayName=l._V.displayName;let c=t.forwardRef((e,r)=>{let{className:a,...t}=e;return(0,s.jsx)(l.H4,{ref:r,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...t})});c.displayName=l.H4.displayName;var d=a(8857);function m(e){let{src:r,fallback:a,overallProgress:t,className:l}=e,m=d.ranks.slice().reverse().findIndex(e=>t>=e.percentage),u=-1!==m?d.ranks[d.ranks.length-1-m]:null,x=null==u?void 0:u.icon;return(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsxs)(i,{className:(0,n.cn)(l),children:[(0,s.jsx)(o,{src:r,alt:"User avatar"}),(0,s.jsx)(c,{children:a})]}),u&&x&&(0,s.jsx)("div",{className:"absolute -bottom-1 -left-1 bg-background rounded-full p-0.5",children:(0,s.jsx)("div",{className:(0,n.cn)("flex h-5 w-5 items-center justify-center rounded-full",u.color.startsWith("text-")?"":"bg-card"),children:(0,s.jsx)(x,{className:(0,n.cn)("h-4 w-4",u.color)})})})]})}},8857:(e,r,a)=>{a.r(r),a.d(r,{default:()=>q,ranks:()=>Y});var s=a(5155),t=a(6695),l=a(7313),n=a(5731),i=a(4601),o=a(5859),c=a(462),d=a(7105),m=a(1816),u=a(658),x=a(1467),h=a(6936),f=a(9502),g=a(8027),p=a(8917),v=a(8962),j=a(5268),b=a(9678),N=a(4913),y=a(286),w=a(2115),k=a(8082),A=a(9434);let M=k.Kq,C=k.bL,L=k.l9,P=w.forwardRef((e,r)=>{let{className:a,sideOffset:t=4,...l}=e;return(0,s.jsx)(k.UC,{ref:r,sideOffset:t,className:(0,A.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...l})});P.displayName=k.UC.displayName;var R=a(7655);let _=w.forwardRef((e,r)=>{let{className:a,children:t,...l}=e;return(0,s.jsxs)(R.bL,{ref:r,className:(0,A.cn)("relative overflow-hidden",a),...l,children:[(0,s.jsx)(R.LM,{className:"h-full w-full rounded-[inherit]",children:t}),(0,s.jsx)(I,{}),(0,s.jsx)(R.OK,{})]})});_.displayName=R.bL.displayName;let I=w.forwardRef((e,r)=>{let{className:a,orientation:t="vertical",...l}=e;return(0,s.jsx)(R.VM,{ref:r,orientation:t,className:(0,A.cn)("flex touch-none select-none transition-colors","vertical"===t&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===t&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",a),...l,children:(0,s.jsx)(R.lr,{className:"relative flex-1 rounded-full bg-border"})})});I.displayName=R.VM.displayName;var U=a(285),W=a(965),T=a(3158);let S=e=>{var r;let{ranks:a,userProgress:l}=e,n=a.slice().reverse().findIndex(e=>l>=e.percentage),i=-1!==n?a[a.length-1-n]:null,o=a.findIndex(e=>l<e.percentage),c=-1!==o?a[o]:null,d=(0,w.useRef)(null),m=(null==(r=a[a.length-1])?void 0:r.percentage)||1,u=e=>{if(d.current){let r=d.current.querySelector("div[data-radix-scroll-area-viewport]");r&&r.scrollBy({left:"left"===e?-300:300,behavior:"smooth"})}};return(0,s.jsxs)(t.Zp,{children:[(0,s.jsxs)(t.aR,{children:[(0,s.jsx)(t.ZB,{children:"My Achievements"}),(0,s.jsxs)(t.BT,{children:["Your total average weekly progress is ",(0,s.jsxs)("strong",{children:[l.toFixed(1),"%"]}),".",i&&" You have achieved the rank of ".concat(i.name,". "),c?"You are ".concat((c.percentage-l).toFixed(1),"% away from the next rank: ").concat(c.name,"."):"You have reached the highest rank!"]})]}),(0,s.jsx)(t.Wu,{className:"pt-4",children:(0,s.jsxs)("div",{className:"relative flex items-center",children:[(0,s.jsx)(U.$,{variant:"outline",size:"icon",className:"h-8 w-8 absolute left-0 z-20",onClick:()=>u("left"),children:(0,s.jsx)(W.A,{className:"h-4 w-4"})}),(0,s.jsxs)(_,{className:"w-full whitespace-nowrap px-12",ref:d,children:[(0,s.jsxs)("div",{className:"relative w-full pt-4 pb-10",style:{minWidth:"".concat(8*a.length,"rem")},children:[(0,s.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 h-0.5 bg-border w-full"}),(0,s.jsx)("div",{className:"absolute top-1/2 -translate-y-1/2 h-0.5 bg-primary",style:{width:"".concat(Math.min(l/m*100,100),"%")}}),(0,s.jsx)("div",{className:"relative flex justify-between w-full",children:a.map(e=>{let r=e.icon,a=l>=e.percentage;return(0,s.jsx)(M,{children:(0,s.jsxs)(C,{children:[(0,s.jsx)(L,{asChild:!0,children:(0,s.jsx)("div",{className:"flex flex-col items-center cursor-pointer",style:{position:"absolute",left:"".concat(e.percentage/m*100,"%"),transform:"translateX(-50%)"},children:(0,s.jsx)("div",{className:(0,A.cn)("h-8 w-8 rounded-full flex items-center justify-center z-10 border-2 bg-card",a?"border-primary":"border-border"),children:(0,s.jsx)(r,{className:(0,A.cn)("h-5 w-5",a?e.color:"text-muted-foreground")})})})}),(0,s.jsxs)(P,{children:[(0,s.jsx)("p",{className:"font-semibold",children:e.name}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Required: ",e.percentage,"% Avg. Progress"]})]})]})},e.name)})})]}),(0,s.jsx)(I,{orientation:"horizontal"})]}),(0,s.jsx)(U.$,{variant:"outline",size:"icon",className:"h-8 w-8 absolute right-0 z-20",onClick:()=>u("right"),children:(0,s.jsx)(T.A,{className:"h-4 w-4"})})]})})]})};var F=a(2360),z=a(1950),Z=a(1966),B=a(5317),E=a(4237);let K=(0,a(2085).F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function O(e){let{className:r,variant:a,...t}=e;return(0,s.jsx)("div",{className:(0,A.cn)(K({variant:a}),r),...t})}let Y=[{name:"Recruit",percentage:0,icon:n.A,color:"text-slate-500"},{name:"Spark",percentage:50,icon:i.A,color:"text-slate-400"},{name:"Private",percentage:100,icon:o.A,color:"text-green-500"},{name:"Tactician",percentage:200,icon:c.A,color:"text-green-400"},{name:"Sapper",percentage:300,icon:d.A,color:"text-cyan-500"},{name:"Hardcore",percentage:400,icon:m.A,color:"text-cyan-400"},{name:"Sergeant",percentage:500,icon:u.A,color:"text-blue-500"},{name:"Ranger",percentage:600,icon:x.A,color:"text-blue-400"},{name:"Gladiator",percentage:700,icon:h.A,color:"text-purple-500"},{name:"Barbarian",percentage:800,icon:f.A,color:"text-purple-400"},{name:"Beast",percentage:900,icon:g.A,color:"text-pink-500"},{name:"Major",percentage:1e3,icon:p.A,color:"text-pink-400"},{name:"Vanguard",percentage:1250,icon:v.A,color:"text-orange-500"},{name:"Colonel",percentage:1500,icon:j.A,color:"text-orange-400"},{name:"Warlord",percentage:2e3,icon:b.A,color:"text-yellow-500"},{name:"General",percentage:2500,icon:N.A,color:"text-yellow-400"},{name:"Titan",percentage:3500,icon:n.A,color:"text-amber-500"},{name:"Legend",percentage:4500,icon:i.A,color:"text-red-500"},{name:"Mythic",percentage:5e3,icon:c.A,color:"text-rose-500"}];function V(e){if(!e||0===e.length)return 0;let r={};e.forEach(e=>{r[e.week]||(r[e.week]={tmar:0,strength:0,hiit:0,cardio:0}),r[e.week].tmar+=e.tmarMMinutes,r[e.week].strength+=e.resistanceLbs,r[e.week].hiit+=e.hiitMinutes;let a=e.cardioMilesRunning/z.u_.RUN_RUCK_WALK.goal+e.cardioMilesRucking/z.u_.RUN_RUCK_WALK.goal+e.cardioMilesWalking/z.u_.RUN_RUCK_WALK.goal+e.cardioMilesElliptical/z.u_.ELLIPTICAL_ROW.goal+e.cardioMilesRowing/z.u_.ELLIPTICAL_ROW.goal+e.cardioMetersSwimming/z.u_.SWIM.goal+e.cardioMilesCycling/z.u_.CYCLE.goal;r[e.week].cardio+=100*a});let a=Object.keys(r).length;if(0===a)return 0;let s=0,t=0,l=0,n=0;return Object.values(r).forEach(e=>{s+=e.tmar/z.Hk*100,t+=e.strength/z.Ct*100,l+=e.hiit/z.NU*100,n+=e.cardio}),(s/a+t/a+l/a+n/a)/4}function H(e){let{users:r,workoutLogs:a}=e,l=(0,w.useMemo)(()=>{if(!r||!a)return[];let e=a.reduce((e,r)=>(e[r.userProfileId]||(e[r.userProfileId]=[]),e[r.userProfileId].push(r),e),{});return r.map(r=>({...r,progress:V(e[r.id]||[])})).sort((e,r)=>r.progress-e.progress)},[r,a]);return l&&0!==l.length?(0,s.jsx)(t.Wu,{className:"space-y-4 p-4",children:l.map((e,r)=>{var a;return(0,s.jsxs)("div",{className:"flex items-center gap-4 p-2 rounded-lg border bg-card-foreground/5",children:[(0,s.jsx)(O,{variant:"secondary",className:"text-lg font-bold w-12 h-12 flex items-center justify-center rounded-full",children:r+1}),(0,s.jsx)(E.p,{src:e.avatarUrl,fallback:(null==(a=e.displayName)?void 0:a.charAt(0))||"U",overallProgress:e.progress,className:"h-12 w-12"}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)("p",{className:"font-semibold text-lg",children:e.displayName}),e.isSoldier&&e.rank&&e.unit&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:[e.rank,", ",e.unit]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-bold text-xl text-primary",children:[e.progress.toFixed(1),"%"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Avg. Progress"})]})]},e.id)})}):(0,s.jsxs)(t.Wu,{className:"text-center text-muted-foreground p-8",children:[(0,s.jsx)(y.A,{className:"mx-auto h-12 w-12"}),(0,s.jsx)("h3",{className:"mt-4 text-xl font-semibold",children:"No Participants Yet"}),(0,s.jsx)("p",{children:"As soon as users start logging their workouts, they will appear here."})]})}function X(e){let{users:r,workoutLogs:a,noTeamsMessage:l}=e,n=(0,w.useMemo)(()=>{if(!r||!a)return[];let e=a.reduce((e,r)=>(e[r.userProfileId]||(e[r.userProfileId]=[]),e[r.userProfileId].push(r),e),{});return Object.values(r.map(r=>({...r,progress:V(e[r.id]||[])})).reduce((e,r)=>(r.teamName&&(e[r.teamName]||(e[r.teamName]={name:r.teamName,members:[],totalProgress:0,memberCount:0}),e[r.teamName].members.push(r),e[r.teamName].totalProgress+=r.progress,e[r.teamName].memberCount++),e),{})).map(e=>({...e,averageProgress:e.memberCount>0?e.totalProgress/e.memberCount:0})).sort((e,r)=>r.averageProgress-e.averageProgress)},[r,a]);return n&&0!==n.length?(0,s.jsx)(t.Wu,{className:"space-y-4 p-4",children:n.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-center gap-4 p-2 rounded-lg border bg-card-foreground/5",children:[(0,s.jsx)(O,{variant:"secondary",className:"text-lg font-bold w-12 h-12 flex items-center justify-center rounded-full flex-shrink-0",children:r+1}),(0,s.jsxs)("div",{className:"flex-grow",children:[(0,s.jsx)("p",{className:"font-semibold text-lg",children:e.name}),(0,s.jsxs)("div",{className:"flex -space-x-2 overflow-hidden mt-2",children:[e.members.slice(0,5).map(e=>{var r;return(0,s.jsx)(E.p,{src:e.avatarUrl,fallback:(null==(r=e.displayName)?void 0:r.charAt(0))||"U",overallProgress:e.progress,className:"h-8 w-8 border-2 border-background"},e.id)}),e.members.length>5&&(0,s.jsxs)("div",{className:"flex items-center justify-center h-8 w-8 rounded-full bg-muted text-xs font-semibold",children:["+",e.members.length-5]})]})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"font-bold text-xl text-primary",children:[e.averageProgress.toFixed(1),"%"]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Avg. Progress"})]})]},e.name))}):(0,s.jsxs)(t.Wu,{className:"text-center text-muted-foreground p-8",children:[(0,s.jsx)(y.A,{className:"mx-auto h-12 w-12"}),(0,s.jsx)("h3",{className:"mt-4 text-xl font-semibold",children:l.title}),(0,s.jsx)("p",{children:l.description})]})}function q(){let{userProfile:e}=(0,F.H)(),r=null;try{r=(0,Z.useFirestore)()}catch(e){console.log("Firestore not available - running in demo mode")}let a=(0,Z.useMemoFirebase)(()=>r?(0,B.P)((0,B.rJ)(r,"users")):null,[r]),{data:n}=r?(0,Z.useCollection)(a):{data:null},i=(0,Z.useMemoFirebase)(()=>r?(0,B.P)((0,B.rJ)(r,"workoutLogs")):null,[r]),{data:o}=r?(0,Z.useCollection)(i):{data:null},c=(0,w.useMemo)(()=>(null==n?void 0:n.filter(e=>e.isSoldier))||[],[n]),d=(0,w.useMemo)(()=>(null==n?void 0:n.filter(e=>e.teamName&&e.isSoldier))||[],[n]),m=(0,w.useMemo)(()=>(null==n?void 0:n.filter(e=>e.teamName&&!e.isSoldier))||[],[n]),u=(0,w.useMemo)(()=>(null==n?void 0:n.filter(e=>!e.isSoldier))||[],[n]),x=(0,w.useMemo)(()=>V((null==o?void 0:o.filter(r=>r.userProfileId===(null==e?void 0:e.id)))||[]),[o,e]);return(0,s.jsxs)("div",{className:"container mx-auto space-y-6",children:[(0,s.jsx)(S,{ranks:Y,userProgress:x}),(0,s.jsxs)(l.tU,{defaultValue:"individual",className:"w-full",children:[(0,s.jsxs)(l.j7,{className:"grid w-full grid-cols-4",children:[(0,s.jsx)(l.Xi,{value:"individual",children:"Individuals"}),(0,s.jsx)(l.Xi,{value:"teams",children:"Teams"}),(0,s.jsx)(l.Xi,{value:"community",children:"Community Teams"}),(0,s.jsx)(l.Xi,{value:"family",children:"Civilians/Family"})]}),(0,s.jsx)(l.av,{value:"individual",children:(0,s.jsxs)(t.Zp,{children:[(0,s.jsx)(t.aR,{children:(0,s.jsx)(t.ZB,{children:"Individual Leaderboard"})}),(0,s.jsx)(H,{users:c,workoutLogs:o})]})}),(0,s.jsx)(l.av,{value:"teams",children:(0,s.jsxs)(t.Zp,{children:[(0,s.jsx)(t.aR,{children:(0,s.jsx)(t.ZB,{children:"Team Leaderboard"})}),(0,s.jsx)(X,{users:d,workoutLogs:o,noTeamsMessage:{title:"No Official Teams Yet",description:"Soldier-based teams will appear here once members start logging workouts."}})]})}),(0,s.jsx)(l.av,{value:"community",children:(0,s.jsxs)(t.Zp,{children:[(0,s.jsx)(t.aR,{children:(0,s.jsx)(t.ZB,{children:"Community Team Leaderboard"})}),(0,s.jsx)(X,{users:m,workoutLogs:o,noTeamsMessage:{title:"No Community Teams Yet",description:"Teams created by civilians and family will appear here."}})]})}),(0,s.jsx)(l.av,{value:"family",children:(0,s.jsxs)(t.Zp,{children:[(0,s.jsx)(t.aR,{children:(0,s.jsx)(t.ZB,{children:"Civilian & Family Leaderboard"})}),(0,s.jsx)(H,{users:u,workoutLogs:o})]})})]})]})}}}]);